{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\songe\\\\Documents\\\\Project\\\\SummerProject\\\\StarlingUI-frontend\\\\src\\\\components\\\\deployment-menu\\\\deploy\\\\DeployPerNode.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport DroneItemSelection from './DroneItemSelection';\nimport DroneItem from './DroneItem';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function DeployPerNode(_ref) {\n  _s();\n\n  let {\n    nodeToMap,\n    completeNode,\n    allDrones,\n    handleMappingChange,\n    selectedDrones,\n    setSelectedDrones,\n    sync,\n    setSync\n  } = _ref;\n  const [mappedDrones, setMappedDrones] = useState(nodeToMap.mappedDrones);\n  useEffect(() => {\n    if (sync === true) {\n      setSync(false);\n      removeAll();\n    }\n  }, [mappedDrones, sync]);\n\n  function handleChange(changes) {\n    console.log(\"change\" + nodeToMap.nodeID);\n    handleMappingChange(nodeToMap.nodeID, { ...nodeToMap,\n      ...changes\n    });\n  } //drone now is name, not id\n\n\n  function removeDrone(name) {\n    console.log(\"remove drone\");\n    setMappedDrones(mappedDrones.filter(drone => drone !== name));\n    setSelectedDrones(selectedDrones.filter(drone => drone !== name));\n    handleChange({\n      mappedDrones: mappedDrones.filter(drone => drone !== name)\n    });\n  } //drone now is name, not id\n\n\n  function addDrone(name) {\n    console.log(\"add drone\");\n    setMappedDrones([...mappedDrones, name]);\n    setSelectedDrones([...selectedDrones, name]);\n    handleChange({\n      mappedDrones: [...mappedDrones, name]\n    });\n  }\n\n  function removeAll() {\n    console.log(\"remove all\");\n    setMappedDrones([]);\n    setSelectedDrones([]);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(DroneItemSelection, {\n      completeNode: completeNode,\n      addDrone: addDrone,\n      options: allDrones === null || allDrones === void 0 ? void 0 : allDrones.filter(x => !(selectedDrones !== null && selectedDrones !== void 0 && selectedDrones.includes(x.nodeName)))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this), mappedDrones === null || mappedDrones === void 0 ? void 0 : mappedDrones.map(drone => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(DroneItem, {\n        allDrones: allDrones,\n        drone: drone,\n        removeDrone: removeDrone\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 48\n      }, this)\n    }, drone, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 31\n    }, this))]\n  }, void 0, true);\n}\n\n_s(DeployPerNode, \"bY53rX0gn0Lk0/vwLwDm4YNsF5k=\");\n\n_c = DeployPerNode;\n\nvar _c;\n\n$RefreshReg$(_c, \"DeployPerNode\");","map":{"version":3,"names":["React","useState","useEffect","DroneItemSelection","DroneItem","DeployPerNode","nodeToMap","completeNode","allDrones","handleMappingChange","selectedDrones","setSelectedDrones","sync","setSync","mappedDrones","setMappedDrones","removeAll","handleChange","changes","console","log","nodeID","removeDrone","name","filter","drone","addDrone","x","includes","nodeName","map"],"sources":["C:/Users/songe/Documents/Project/SummerProject/StarlingUI-frontend/src/components/deployment-menu/deploy/DeployPerNode.js"],"sourcesContent":["import React, {useState,useEffect} from 'react';\r\nimport DroneItemSelection from './DroneItemSelection';\r\nimport DroneItem from './DroneItem';\r\n\r\nexport default function DeployPerNode({nodeToMap, completeNode, allDrones, handleMappingChange, selectedDrones,setSelectedDrones,sync, setSync}) {\r\n\r\n    const [mappedDrones, setMappedDrones] = useState(nodeToMap.mappedDrones);\r\n\r\n    useEffect(()=>{\r\n        if(sync===true){\r\n          setSync(false);\r\n          removeAll();\r\n        }\r\n      },[mappedDrones,sync]);\r\n    \r\n    function handleChange(changes){\r\n        console.log(\"change\"+nodeToMap.nodeID);\r\n        handleMappingChange(nodeToMap.nodeID, {...nodeToMap,...changes});\r\n    }\r\n\r\n    //drone now is name, not id\r\n    function removeDrone(name){\r\n        console.log(\"remove drone\");\r\n        setMappedDrones(mappedDrones.filter(drone=>drone!==name));\r\n        setSelectedDrones(selectedDrones.filter(drone=>drone!==name));\r\n        handleChange({mappedDrones: mappedDrones.filter(drone=>drone!==name)});\r\n    }\r\n\r\n    //drone now is name, not id\r\n    function addDrone(name){\r\n        console.log(\"add drone\");\r\n        setMappedDrones([...mappedDrones,name]);\r\n        setSelectedDrones([...selectedDrones,name])\r\n        handleChange({mappedDrones: [...mappedDrones,name]});\r\n    }\r\n\r\n    function removeAll(){\r\n      console.log(\"remove all\");\r\n      setMappedDrones([]);\r\n      setSelectedDrones([]);\r\n    }\r\n\r\n\r\n  return (\r\n    <>\r\n      <DroneItemSelection\r\n        completeNode={completeNode} \r\n        addDrone={addDrone} \r\n        options={allDrones?.filter(x => !selectedDrones?.includes(x.nodeName))}></DroneItemSelection>\r\n    {mappedDrones?.map(drone=><div key={drone}><DroneItem  allDrones={allDrones} drone={drone} removeDrone={removeDrone}></DroneItem></div>)}\r\n    </>\r\n  )\r\n}\r\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,QAAf,EAAwBC,SAAxB,QAAwC,OAAxC;AACA,OAAOC,kBAAP,MAA+B,sBAA/B;AACA,OAAOC,SAAP,MAAsB,aAAtB;;;AAEA,eAAe,SAASC,aAAT,OAAkI;EAAA;;EAAA,IAA3G;IAACC,SAAD;IAAYC,YAAZ;IAA0BC,SAA1B;IAAqCC,mBAArC;IAA0DC,cAA1D;IAAyEC,iBAAzE;IAA2FC,IAA3F;IAAiGC;EAAjG,CAA2G;EAE7I,MAAM,CAACC,YAAD,EAAeC,eAAf,IAAkCd,QAAQ,CAACK,SAAS,CAACQ,YAAX,CAAhD;EAEAZ,SAAS,CAAC,MAAI;IACV,IAAGU,IAAI,KAAG,IAAV,EAAe;MACbC,OAAO,CAAC,KAAD,CAAP;MACAG,SAAS;IACV;EACF,CALM,EAKL,CAACF,YAAD,EAAcF,IAAd,CALK,CAAT;;EAOA,SAASK,YAAT,CAAsBC,OAAtB,EAA8B;IAC1BC,OAAO,CAACC,GAAR,CAAY,WAASd,SAAS,CAACe,MAA/B;IACAZ,mBAAmB,CAACH,SAAS,CAACe,MAAX,EAAmB,EAAC,GAAGf,SAAJ;MAAc,GAAGY;IAAjB,CAAnB,CAAnB;EACH,CAd4I,CAgB7I;;;EACA,SAASI,WAAT,CAAqBC,IAArB,EAA0B;IACtBJ,OAAO,CAACC,GAAR,CAAY,cAAZ;IACAL,eAAe,CAACD,YAAY,CAACU,MAAb,CAAoBC,KAAK,IAAEA,KAAK,KAAGF,IAAnC,CAAD,CAAf;IACAZ,iBAAiB,CAACD,cAAc,CAACc,MAAf,CAAsBC,KAAK,IAAEA,KAAK,KAAGF,IAArC,CAAD,CAAjB;IACAN,YAAY,CAAC;MAACH,YAAY,EAAEA,YAAY,CAACU,MAAb,CAAoBC,KAAK,IAAEA,KAAK,KAAGF,IAAnC;IAAf,CAAD,CAAZ;EACH,CAtB4I,CAwB7I;;;EACA,SAASG,QAAT,CAAkBH,IAAlB,EAAuB;IACnBJ,OAAO,CAACC,GAAR,CAAY,WAAZ;IACAL,eAAe,CAAC,CAAC,GAAGD,YAAJ,EAAiBS,IAAjB,CAAD,CAAf;IACAZ,iBAAiB,CAAC,CAAC,GAAGD,cAAJ,EAAmBa,IAAnB,CAAD,CAAjB;IACAN,YAAY,CAAC;MAACH,YAAY,EAAE,CAAC,GAAGA,YAAJ,EAAiBS,IAAjB;IAAf,CAAD,CAAZ;EACH;;EAED,SAASP,SAAT,GAAoB;IAClBG,OAAO,CAACC,GAAR,CAAY,YAAZ;IACAL,eAAe,CAAC,EAAD,CAAf;IACAJ,iBAAiB,CAAC,EAAD,CAAjB;EACD;;EAGH,oBACE;IAAA,wBACE,QAAC,kBAAD;MACE,YAAY,EAAEJ,YADhB;MAEE,QAAQ,EAAEmB,QAFZ;MAGE,OAAO,EAAElB,SAAF,aAAEA,SAAF,uBAAEA,SAAS,CAAEgB,MAAX,CAAkBG,CAAC,IAAI,EAACjB,cAAD,aAACA,cAAD,eAACA,cAAc,CAAEkB,QAAhB,CAAyBD,CAAC,CAACE,QAA3B,CAAD,CAAvB;IAHX;MAAA;MAAA;MAAA;IAAA,QADF,EAKCf,YALD,aAKCA,YALD,uBAKCA,YAAY,CAAEgB,GAAd,CAAkBL,KAAK,iBAAE;MAAA,uBAAiB,QAAC,SAAD;QAAY,SAAS,EAAEjB,SAAvB;QAAkC,KAAK,EAAEiB,KAAzC;QAAgD,WAAW,EAAEH;MAA7D;QAAA;QAAA;QAAA;MAAA;IAAjB,GAAUG,KAAV;MAAA;MAAA;MAAA;IAAA,QAAzB,CALD;EAAA,gBADF;AASD;;GAhDuBpB,a;;KAAAA,a"},"metadata":{},"sourceType":"module"}