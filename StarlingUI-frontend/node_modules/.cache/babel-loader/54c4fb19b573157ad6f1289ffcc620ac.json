{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\songe\\\\Documents\\\\Project\\\\SummerProject\\\\StarlingUI-frontend\\\\src\\\\components\\\\monitor-contianer\\\\ContainerTerminal.js\",\n    _s = $RefreshSig$();\n\nimport { useParams } from \"react-router-dom\";\nimport { Terminal } from \"xterm\";\nimport { AttachAddon } from \"xterm-addon-attach\";\nimport { FitAddon } from \"xterm-addon-fit\";\nimport { useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet socket;\nlet cols;\nlet rows;\nconst fitAddon = new FitAddon();\nexport default function ContainerTerminal() {\n  _s();\n\n  const {\n    name,\n    namespace,\n    container\n  } = useParams(); //console.log(name,namespace,container);\n\n  useEffect(() => {\n    cols = parseInt(document.body.clientWidth / 9);\n    rows = parseInt(document.body.clientHeight / 18);\n    const terminal = new Terminal({\n      convertEol: true,\n      cursorBlink: true,\n      rows: rows,\n      cols: cols,\n      fontSize: 18,\n      fontFamily: `'Fira Mono', monospace`,\n      theme: {\n        foreground: '#32e6b7'\n      }\n    });\n    terminal.open(document.getElementById(\"terminal-container\"));\n    let url = 'ws://localhost:8080/container/shell';\n    url += '?name=' + name + '&namespace=' + namespace + '&container=' + container + '&cols=' + cols + '&rows=' + rows; // eslint-disable-next-line react-hooks/exhaustive-deps\n\n    socket = new WebSocket(url);\n    const attachAddon = new AttachAddon(socket); // Attach the socket to term\n\n    terminal.loadAddon(attachAddon);\n    terminal.loadAddon(fitAddon);\n    fitAddon.fit();\n\n    const debounce = (fn, delay) => {\n      let timer;\n      return function () {\n        if (timer) {\n          clearTimeout(timer);\n        }\n\n        timer = setTimeout(() => {\n          fn();\n        }, delay);\n      };\n    };\n\n    function resize() {\n      if (socket !== null) {\n        fitAddon.fit();\n        terminal.scrollToBottom();\n        cols = parseInt(document.body.clientWidth / 9);\n        rows = parseInt(document.body.clientHeight / 18);\n        socket.send(\"stty cols \" + cols + \" rows \" + rows + \" \");\n        console.log(\"stty cols \" + cols + \" rows \" + rows + \" \");\n      }\n    }\n\n    window.addEventListener(\"resize\", debounce(resize, 1000));\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"0\",\n        border: \"0\",\n        margin: \"0\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"terminal-container\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}\n\n_s(ContainerTerminal, \"i1O2yJpcbKbmlDcLUM4OC7oPxmA=\", false, function () {\n  return [useParams];\n});\n\n_c = ContainerTerminal;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContainerTerminal\");","map":{"version":3,"names":["useParams","Terminal","AttachAddon","FitAddon","useEffect","socket","cols","rows","fitAddon","ContainerTerminal","name","namespace","container","parseInt","document","body","clientWidth","clientHeight","terminal","convertEol","cursorBlink","fontSize","fontFamily","theme","foreground","open","getElementById","url","WebSocket","attachAddon","loadAddon","fit","debounce","fn","delay","timer","clearTimeout","setTimeout","resize","scrollToBottom","send","console","log","window","addEventListener","padding","border","margin"],"sources":["C:/Users/songe/Documents/Project/SummerProject/StarlingUI-frontend/src/components/monitor-contianer/ContainerTerminal.js"],"sourcesContent":["import { useParams } from \"react-router-dom\"\r\nimport {Terminal} from \"xterm\";\r\nimport {AttachAddon} from \"xterm-addon-attach\";\r\nimport {FitAddon} from \"xterm-addon-fit\";\r\nimport {useEffect} from \"react\";\r\n\r\nlet socket;\r\nlet cols;\r\nlet rows;\r\nconst fitAddon = new FitAddon();\r\nexport default function ContainerTerminal(){\r\n\r\n\r\n    const { name,namespace,container } = useParams();\r\n    //console.log(name,namespace,container);\r\n\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        cols=parseInt(document.body.clientWidth /9)\r\n        rows=parseInt(document.body.clientHeight / 18)\r\n        const terminal = new Terminal({\r\n            convertEol: true,\r\n            cursorBlink: true,\r\n            rows:rows,\r\n            cols:cols,\r\n            fontSize: 18,\r\n            fontFamily: `'Fira Mono', monospace`,\r\n            theme: {\r\n                foreground: '#32e6b7',\r\n            }\r\n        });\r\n\r\n\r\n        terminal.open(document.getElementById(\"terminal-container\"));\r\n\r\n\r\n        let url = 'ws://localhost:8080/container/shell';\r\n        url += '?name=' + name\r\n            + '&namespace=' + namespace\r\n            + '&container=' + container\r\n            + '&cols=' + cols\r\n            + '&rows=' + rows;\r\n\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n        socket = new WebSocket(url);\r\n\r\n        const attachAddon = new AttachAddon(socket);\r\n        // Attach the socket to term\r\n        terminal.loadAddon(attachAddon);\r\n        terminal.loadAddon(fitAddon);\r\n        fitAddon.fit();\r\n\r\n        const debounce = (fn, delay) => {\r\n            let timer;\r\n            return function() {\r\n                if (timer) {\r\n                    clearTimeout(timer);\r\n                }\r\n                timer = setTimeout(() => {\r\n                    fn();\r\n                }, delay);\r\n            }\r\n        };\r\n\r\n        function resize() {\r\n            if(socket !== null){\r\n                fitAddon.fit();\r\n                terminal.scrollToBottom()\r\n                cols=parseInt(document.body.clientWidth /9)\r\n                rows=parseInt(document.body.clientHeight / 18)\r\n                socket.send(\"stty cols \" + cols + \" rows \"+ rows + \" \");\r\n                console.log(\"stty cols \" + cols + \" rows \"+ rows + \" \");\r\n            }\r\n\r\n        }\r\n        window.addEventListener(\"resize\", debounce(resize,1000))\r\n\r\n        \r\n    },[]);\r\n\r\n\r\n\r\n\r\n\r\n    return(\r\n        <>\r\n            <div style={{padding: \"0\",border: \"0\",margin: \"0\"}}>\r\n                <div id=\"terminal-container\"></div>\r\n            </div>\r\n        </>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}