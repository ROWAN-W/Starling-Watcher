{"ast":null,"code":"!function (t, e) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = e() : \"function\" == typeof define && define.amd ? define([], e) : \"object\" == typeof exports ? exports.AttachAddon = e() : t.AttachAddon = e();\n}(window, function () {\n  return function (t) {\n    var e = {};\n\n    function n(o) {\n      if (e[o]) return e[o].exports;\n      var r = e[o] = {\n        i: o,\n        l: !1,\n        exports: {}\n      };\n      return t[o].call(r.exports, r, r.exports, n), r.l = !0, r.exports;\n    }\n\n    return n.m = t, n.c = e, n.d = function (t, e, o) {\n      n.o(t, e) || Object.defineProperty(t, e, {\n        enumerable: !0,\n        get: o\n      });\n    }, n.r = function (t) {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n    }, n.t = function (t, e) {\n      if (1 & e && (t = n(t)), 8 & e) return t;\n      if (4 & e && \"object\" == typeof t && t && t.__esModule) return t;\n      var o = Object.create(null);\n      if (n.r(o), Object.defineProperty(o, \"default\", {\n        enumerable: !0,\n        value: t\n      }), 2 & e && \"string\" != typeof t) for (var r in t) n.d(o, r, function (e) {\n        return t[e];\n      }.bind(null, r));\n      return o;\n    }, n.n = function (t) {\n      var e = t && t.__esModule ? function () {\n        return t.default;\n      } : function () {\n        return t;\n      };\n      return n.d(e, \"a\", e), e;\n    }, n.o = function (t, e) {\n      return Object.prototype.hasOwnProperty.call(t, e);\n    }, n.p = \"\", n(n.s = 0);\n  }([function (t, e, n) {\n    \"use strict\";\n\n    Object.defineProperty(e, \"__esModule\", {\n      value: !0\n    }), e.AttachAddon = void 0;\n\n    var o = function () {\n      function t(t, e) {\n        this._disposables = [], this._socket = t, this._socket.binaryType = \"arraybuffer\", this._bidirectional = !e || !1 !== e.bidirectional;\n      }\n\n      return t.prototype.activate = function (t) {\n        var e = this;\n        this._disposables.push(r(this._socket, \"message\", function (e) {\n          var n = e.data;\n          t.write(\"string\" == typeof n ? n : new Uint8Array(n));\n        })), this._bidirectional && (this._disposables.push(t.onData(function (t) {\n          return e._sendData(t);\n        })), this._disposables.push(t.onBinary(function (t) {\n          return e._sendBinary(t);\n        }))), this._disposables.push(r(this._socket, \"close\", function () {\n          return e.dispose();\n        })), this._disposables.push(r(this._socket, \"error\", function () {\n          return e.dispose();\n        }));\n      }, t.prototype.dispose = function () {\n        this._disposables.forEach(function (t) {\n          return t.dispose();\n        });\n      }, t.prototype._sendData = function (t) {\n        1 === this._socket.readyState && this._socket.send(t);\n      }, t.prototype._sendBinary = function (t) {\n        if (1 === this._socket.readyState) {\n          for (var e = new Uint8Array(t.length), n = 0; n < t.length; ++n) e[n] = 255 & t.charCodeAt(n);\n\n          this._socket.send(e);\n        }\n      }, t;\n    }();\n\n    function r(t, e, n) {\n      return t.addEventListener(e, n), {\n        dispose: function () {\n          n && t.removeEventListener(e, n);\n        }\n      };\n    }\n\n    e.AttachAddon = o;\n  }]);\n});","map":{"version":3,"mappings":"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","names":["root","factory","exports","module","define","amd","AttachAddon","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","socket","options","this","_socket","binaryType","_bidirectional","bidirectional","terminal","_disposables","push","addSocketListener","data","ev","write","Uint8Array","onData","_sendData","onBinary","_sendBinary","dispose","forEach","readyState","send","buffer","length","charCodeAt","type","handler","addEventListener","removeEventListener","e"],"sources":["webpack://AttachAddon/webpack/universalModuleDefinition","webpack://AttachAddon/webpack/bootstrap","webpack://AttachAddon/src/AttachAddon.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"AttachAddon\"] = factory();\n\telse\n\t\troot[\"AttachAddon\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * Copyright (c) 2014, 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n *\n * Implements the attach method, that attaches the terminal to a WebSocket stream.\n */\n\nimport { Terminal, IDisposable, ITerminalAddon } from 'xterm';\n\ninterface IAttachOptions {\n  bidirectional?: boolean;\n}\n\nexport class AttachAddon implements ITerminalAddon {\n  private _socket: WebSocket;\n  private _bidirectional: boolean;\n  private _disposables: IDisposable[] = [];\n\n  constructor(socket: WebSocket, options?: IAttachOptions) {\n    this._socket = socket;\n    // always set binary type to arraybuffer, we do not handle blobs\n    this._socket.binaryType = 'arraybuffer';\n    this._bidirectional = (options && options.bidirectional === false) ? false : true;\n  }\n\n  public activate(terminal: Terminal): void {\n    this._disposables.push(\n      addSocketListener(this._socket, 'message', ev => {\n        const data: ArrayBuffer | string = ev.data;\n        terminal.write(typeof data === 'string' ? data : new Uint8Array(data));\n      })\n    );\n\n    if (this._bidirectional) {\n      this._disposables.push(terminal.onData(data => this._sendData(data)));\n      this._disposables.push(terminal.onBinary(data => this._sendBinary(data)));\n    }\n\n    this._disposables.push(addSocketListener(this._socket, 'close', () => this.dispose()));\n    this._disposables.push(addSocketListener(this._socket, 'error', () => this.dispose()));\n  }\n\n  public dispose(): void {\n    this._disposables.forEach(d => d.dispose());\n  }\n\n  private _sendData(data: string): void {\n    // TODO: do something better than just swallowing\n    // the data if the socket is not in a working condition\n    if (this._socket.readyState !== 1) {\n      return;\n    }\n    this._socket.send(data);\n  }\n\n  private _sendBinary(data: string): void {\n    if (this._socket.readyState !== 1) {\n      return;\n    }\n    const buffer = new Uint8Array(data.length);\n    for (let i = 0; i < data.length; ++i) {\n      buffer[i] = data.charCodeAt(i) & 255;\n    }\n    this._socket.send(buffer);\n  }\n}\n\nfunction addSocketListener<K extends keyof WebSocketEventMap>(socket: WebSocket, type: K, handler: (this: WebSocket, ev: WebSocketEventMap[K]) => any): IDisposable {\n  socket.addEventListener(type, handler);\n  return {\n    dispose: () => {\n      if (!handler) {\n        // Already disposed\n        return;\n      }\n      socket.removeEventListener(type, handler);\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"script"}