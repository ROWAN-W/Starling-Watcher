{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\songe\\\\Documents\\\\Project\\\\SummerProject\\\\StarlingUI-frontend\\\\src\\\\components\\\\deployment-menu\\\\delete\\\\DeleteProject.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport axios from \"axios\";\nimport { ProjectContext } from '../../App';\nimport logo from '../../img/load.gif';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PROJECT_URL = 'http://localhost:8080/design/projects';\nexport default function DeleteProject(props) {\n  _s();\n\n  const {\n    projects,\n    setProjects,\n    handleProjectSelect,\n    handleCurrentUser\n  } = useContext(ProjectContext);\n  const [result, setResult] = useState('');\n  const [savePending, setIsPending] = useState(false);\n  const [error, setError] = useState(null);\n  const [reLogin, setReLogin] = useState(false);\n  useEffect(() => {\n    if (props.trigger === true) {\n      handleProjectDelete();\n    }\n  }, [props.trigger]);\n\n  function handleProjectDelete() {\n    if (props.selectedProject !== null) {\n      setIsPending(true);\n      console.log(\"delete project in project delete!\");\n      deleteToServer(props.selectedProject.id);\n    }\n  }\n\n  function deleteToServer(id) {\n    axios.delete(PROJECT_URL + '/' + id).then(data => {\n      setIsPending(false);\n      setError(null);\n      setResult(\"Your project has been successfully deleted\");\n      console.log(\"delete \" + PROJECT_URL + '/' + id);\n      console.log(data);\n      setProjects(projects.filter(project => project.id !== id));\n      handleProjectSelect(undefined);\n    }).catch(err => {\n      console.log(err.message);\n      setIsPending(false);\n      setResult('');\n\n      if (err.response.status === 401) {\n        setError(\"Authentication is required. Please sign in again.\");\n        setReLogin(true);\n      } //delete this project on the front-end\n      else if (err.response.status === 403) {\n        setError(\"Invalid project ID. The project will be deleted automatically.\");\n        setProjects(projects.filter(project => project.id !== id));\n        handleProjectSelect(undefined);\n      } else {\n        setError(err.message);\n      }\n    });\n  }\n\n  function clearField() {\n    setResult('');\n    setIsPending(false);\n    setError(null);\n  }\n\n  function authenticateAgain() {\n    if (reLogin) {\n      handleCurrentUser(undefined);\n      setReLogin(false);\n    }\n  }\n\n  function message() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [savePending && /*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"wait-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"loading\",\n          src: logo,\n          alt: \"loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 58\n        }, this), \"Please wait...\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 29\n      }, this), !savePending && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"close\",\n        onClick: () => {\n          props.setTrigger(false);\n          clearField();\n          authenticateAgain();\n        },\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 30\n      }, this), error && /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"title-error\",\n        children: \"Delete Project Error\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 23\n      }, this), !error && result !== '' && /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"title-success\",\n        children: \"Success!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 39\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content\",\n        children: error ? error : result\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 13\n      }, this), !savePending && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popup-footer normal\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn short\",\n          onClick: () => {\n            props.setTrigger(false);\n            clearField();\n            authenticateAgain();\n          },\n          children: \"OK\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true);\n  }\n\n  return props.trigger ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"popup-projects\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"popup\",\n      children: message()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 9\n  }, this) : \"\";\n}\n\n_s(DeleteProject, \"Wb1S7X4bpLg1xpc8A48DTGArmTM=\");\n\n_c = DeleteProject;\n\nvar _c;\n\n$RefreshReg$(_c, \"DeleteProject\");","map":{"version":3,"names":["React","useState","useEffect","useContext","axios","ProjectContext","logo","PROJECT_URL","DeleteProject","props","projects","setProjects","handleProjectSelect","handleCurrentUser","result","setResult","savePending","setIsPending","error","setError","reLogin","setReLogin","trigger","handleProjectDelete","selectedProject","console","log","deleteToServer","id","delete","then","data","filter","project","undefined","catch","err","message","response","status","clearField","authenticateAgain","setTrigger"],"sources":["C:/Users/songe/Documents/Project/SummerProject/StarlingUI-frontend/src/components/deployment-menu/delete/DeleteProject.js"],"sourcesContent":["import React, { useState,useEffect, useContext } from 'react';\r\nimport axios from \"axios\";\r\nimport { ProjectContext } from '../../App';\r\nimport logo from '../../img/load.gif';\r\nconst PROJECT_URL = 'http://localhost:8080/design/projects';\r\n\r\nexport default function DeleteProject(props) {\r\n    \r\n    const {projects, setProjects, handleProjectSelect, handleCurrentUser} = useContext(ProjectContext);\r\n\r\n    const [result, setResult] = useState('');\r\n    const [savePending, setIsPending] = useState(false);\r\n    const [error, setError] = useState(null);\r\n    const [reLogin, setReLogin] = useState(false);\r\n\r\n    useEffect(()=>{\r\n        if(props.trigger===true){\r\n            handleProjectDelete();\r\n        }\r\n    },[props.trigger]);\r\n\r\n    function handleProjectDelete(){\r\n        if(props.selectedProject!==null){\r\n            setIsPending(true);\r\n            console.log(\"delete project in project delete!\");\r\n            deleteToServer(props.selectedProject.id);\r\n        }\r\n    }\r\n\r\n    function deleteToServer(id){\r\n\r\n        axios\r\n        .delete(PROJECT_URL+'/'+id)\r\n        .then((data) => {\r\n            setIsPending(false);\r\n            setError(null);\r\n            setResult(\"Your project has been successfully deleted\");\r\n            console.log(\"delete \"+PROJECT_URL+'/'+id);\r\n            console.log(data);\r\n            setProjects(projects.filter(project=>project.id!==id));\r\n            handleProjectSelect(undefined);\r\n        })\r\n        .catch((err) => {\r\n            console.log(err.message);\r\n            setIsPending(false);\r\n            setResult('');\r\n            if(err.response.status===401){\r\n                setError(\"Authentication is required. Please sign in again.\");\r\n                setReLogin(true);\r\n            }\r\n            //delete this project on the front-end\r\n            else if(err.response.status===403){\r\n                setError(\"Invalid project ID. The project will be deleted automatically.\");\r\n                setProjects(projects.filter(project=>project.id!==id));\r\n                handleProjectSelect(undefined);\r\n            }\r\n            else{\r\n                setError(err.message);\r\n            }\r\n        });\r\n      }\r\n\r\n      function clearField(){\r\n        setResult('');\r\n        setIsPending(false);\r\n        setError(null);\r\n      }\r\n\r\n      function authenticateAgain(){\r\n        if(reLogin){\r\n          handleCurrentUser(undefined);\r\n          setReLogin(false);\r\n        }\r\n      }\r\n\r\n\r\n    function message(){\r\n        return(\r\n            <>\r\n            {savePending && <h4 className='wait-message'><img className=\"loading\" src={logo} alt=\"loading...\" />Please wait...</h4>}\r\n            {!savePending && <button className='close' onClick={()=>{props.setTrigger(false);clearField();authenticateAgain()}}>&times;</button>}\r\n            {error && <h2 className='title-error'>Delete Project Error</h2>}\r\n            {!error && result!=='' && <h2 className='title-success'>Success!</h2>}\r\n            <div className='content'>{error? error: result}</div>\r\n            {!savePending && \r\n            <div className='popup-footer normal'>\r\n                <button className='btn short' onClick={()=>{props.setTrigger(false);clearField();authenticateAgain()}}>OK</button>\r\n            </div>}\r\n            \r\n            \r\n            </>\r\n        )\r\n    }\r\n    \r\n    return (props.trigger) ?(\r\n        <div className='popup-projects'>\r\n            <div className='popup'>\r\n                {message()}\r\n            </div>\r\n        </div>\r\n      ): \"\"\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}