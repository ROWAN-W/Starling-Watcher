{"version":3,"file":"react-popper-tooltip.js","sources":["../../src/utils.ts","../../src/usePopperTooltip.ts"],"sourcesContent":["import * as React from 'react';\n\n// kudos to @tannerlinsley https://twitter.com/tannerlinsley\nexport function useGetLatest<T>(val: T) {\n  const ref = React.useRef<T>(val);\n  ref.current = val;\n  return React.useCallback(() => ref.current, []);\n}\n\nconst noop = () => {\n  // do nothing\n};\n\nexport function useControlledState<T>({\n  initial,\n  value,\n  onChange = noop,\n}: {\n  initial?: T;\n  value?: T;\n  onChange?: (state: T) => void;\n}): [T, (state: T) => void] {\n  if (initial === undefined && value === undefined) {\n    throw new TypeError(\n      'Either \"value\" or \"initial\" variable must be set. Now both are undefined'\n    );\n  }\n\n  const [state, setState] = React.useState(initial);\n\n  const getLatest = useGetLatest(state);\n\n  const set = React.useCallback(\n    (updater: T) => {\n      const state = getLatest();\n\n      const updatedState =\n        typeof updater === 'function' ? updater(state) : updater;\n\n      if (typeof updatedState.persist === 'function') updatedState.persist();\n\n      setState(updatedState);\n      if (typeof onChange === 'function') onChange(updatedState);\n    },\n    [getLatest, onChange]\n  );\n\n  const isControlled = value !== undefined;\n\n  return [isControlled ? value! : state!, isControlled ? onChange : set];\n}\n\nexport function generateBoundingClientRect(x = 0, y = 0): () => DOMRect {\n  return () => ({\n    width: 0,\n    height: 0,\n    top: y,\n    right: x,\n    bottom: y,\n    left: x,\n    x: 0,\n    y: 0,\n    toJSON: () => null,\n  });\n}\n","import * as React from 'react';\nimport type { VirtualElement } from '@popperjs/core';\nimport { usePopper } from 'react-popper';\nimport {\n  useControlledState,\n  useGetLatest,\n  generateBoundingClientRect,\n} from './utils';\nimport { Config, PopperOptions, PropsGetterArgs, TriggerType } from './types';\n\nconst virtualElement: VirtualElement = {\n  getBoundingClientRect: generateBoundingClientRect(),\n};\n\nconst defaultConfig: Config = {\n  closeOnOutsideClick: true,\n  closeOnTriggerHidden: false,\n  defaultVisible: false,\n  delayHide: 0,\n  delayShow: 0,\n  followCursor: false,\n  interactive: false,\n  mutationObserverOptions: {\n    attributes: true,\n    childList: true,\n    subtree: true,\n  },\n  offset: [0, 6],\n  trigger: 'hover',\n};\n\nexport function usePopperTooltip(\n  config: Config = {},\n  popperOptions: PopperOptions = {}\n) {\n  // Merging options with default options.\n  // Keys with undefined values are replaced with the default ones if any.\n  // Keys with other values pass through.\n  const finalConfig = (\n    Object.keys(defaultConfig) as Array<keyof typeof defaultConfig>\n  ).reduce(\n    (config, key) => ({\n      ...config,\n      [key]: config[key] !== undefined ? config[key] : defaultConfig[key],\n    }),\n    config\n  );\n\n  const defaultModifiers = React.useMemo(\n    () => [{ name: 'offset', options: { offset: finalConfig.offset } }],\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    Array.isArray(finalConfig.offset) ? finalConfig.offset : []\n  );\n\n  const finalPopperOptions = {\n    ...popperOptions,\n    placement: popperOptions.placement || finalConfig.placement,\n    modifiers: popperOptions.modifiers || defaultModifiers,\n  };\n\n  const [triggerRef, setTriggerRef] = React.useState<HTMLElement | null>(null);\n  const [tooltipRef, setTooltipRef] = React.useState<HTMLElement | null>(null);\n  const [visible, setVisible] = useControlledState({\n    initial: finalConfig.defaultVisible,\n    value: finalConfig.visible,\n    onChange: finalConfig.onVisibleChange,\n  });\n\n  const timer = React.useRef<number>();\n  React.useEffect(() => () => clearTimeout(timer.current), []);\n\n  const { styles, attributes, ...popperProps } = usePopper(\n    finalConfig.followCursor ? virtualElement : triggerRef,\n    tooltipRef,\n    finalPopperOptions\n  );\n\n  const update = popperProps.update;\n\n  const getLatest = useGetLatest({\n    visible,\n    triggerRef,\n    tooltipRef,\n    finalConfig,\n  });\n\n  const isTriggeredBy = React.useCallback(\n    (trigger: TriggerType) => {\n      return Array.isArray(finalConfig.trigger)\n        ? finalConfig.trigger.includes(trigger)\n        : finalConfig.trigger === trigger;\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    Array.isArray(finalConfig.trigger)\n      ? finalConfig.trigger\n      : [finalConfig.trigger]\n  );\n\n  const hideTooltip = React.useCallback(() => {\n    clearTimeout(timer.current);\n    timer.current = window.setTimeout(\n      () => setVisible(false),\n      finalConfig.delayHide\n    );\n  }, [finalConfig.delayHide, setVisible]);\n\n  const showTooltip = React.useCallback(() => {\n    clearTimeout(timer.current);\n    timer.current = window.setTimeout(\n      () => setVisible(true),\n      finalConfig.delayShow\n    );\n  }, [finalConfig.delayShow, setVisible]);\n\n  const toggleTooltip = React.useCallback(() => {\n    if (getLatest().visible) {\n      hideTooltip();\n    } else {\n      showTooltip();\n    }\n  }, [getLatest, hideTooltip, showTooltip]);\n\n  // Handle click outside\n  React.useEffect(() => {\n    if (!getLatest().finalConfig.closeOnOutsideClick) return;\n\n    const handleClickOutside: EventListener = (event) => {\n      const { tooltipRef, triggerRef } = getLatest();\n      const target = event.composedPath?.()?.[0] || event.target;\n      if (target instanceof Node) {\n        if (\n          tooltipRef != null &&\n          triggerRef != null &&\n          !tooltipRef.contains(target) &&\n          !triggerRef.contains(target)\n        ) {\n          hideTooltip();\n        }\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [getLatest, hideTooltip]);\n\n  // Trigger: click\n  React.useEffect(() => {\n    if (triggerRef == null || !isTriggeredBy('click')) return;\n\n    triggerRef.addEventListener('click', toggleTooltip);\n\n    return () => triggerRef.removeEventListener('click', toggleTooltip);\n  }, [triggerRef, isTriggeredBy, toggleTooltip]);\n\n  // Trigger: double-click\n  React.useEffect(() => {\n    if (triggerRef == null || !isTriggeredBy('double-click')) return;\n\n    triggerRef.addEventListener('dblclick', toggleTooltip);\n\n    return () => triggerRef.removeEventListener('dblclick', toggleTooltip);\n  }, [triggerRef, isTriggeredBy, toggleTooltip]);\n\n  // Trigger: right-click\n  React.useEffect(() => {\n    if (triggerRef == null || !isTriggeredBy('right-click')) return;\n\n    const preventDefaultAndToggle: EventListener = (event) => {\n      // Don't show the context menu\n      event.preventDefault();\n      toggleTooltip();\n    };\n\n    triggerRef.addEventListener('contextmenu', preventDefaultAndToggle);\n    return () =>\n      triggerRef.removeEventListener('contextmenu', preventDefaultAndToggle);\n  }, [triggerRef, isTriggeredBy, toggleTooltip]);\n\n  // Trigger: focus\n  React.useEffect(() => {\n    if (triggerRef == null || !isTriggeredBy('focus')) return;\n\n    triggerRef.addEventListener('focus', showTooltip);\n    triggerRef.addEventListener('blur', hideTooltip);\n    return () => {\n      triggerRef.removeEventListener('focus', showTooltip);\n      triggerRef.removeEventListener('blur', hideTooltip);\n    };\n  }, [triggerRef, isTriggeredBy, showTooltip, hideTooltip]);\n\n  // Trigger: hover on trigger\n  React.useEffect(() => {\n    if (triggerRef == null || !isTriggeredBy('hover')) return;\n\n    triggerRef.addEventListener('mouseenter', showTooltip);\n    triggerRef.addEventListener('mouseleave', hideTooltip);\n    return () => {\n      triggerRef.removeEventListener('mouseenter', showTooltip);\n      triggerRef.removeEventListener('mouseleave', hideTooltip);\n    };\n  }, [triggerRef, isTriggeredBy, showTooltip, hideTooltip]);\n\n  // Trigger: hover on tooltip, keep it open if hovered\n  React.useEffect(() => {\n    if (\n      tooltipRef == null ||\n      !isTriggeredBy('hover') ||\n      !getLatest().finalConfig.interactive\n    )\n      return;\n\n    tooltipRef.addEventListener('mouseenter', showTooltip);\n    tooltipRef.addEventListener('mouseleave', hideTooltip);\n    return () => {\n      tooltipRef.removeEventListener('mouseenter', showTooltip);\n      tooltipRef.removeEventListener('mouseleave', hideTooltip);\n    };\n  }, [tooltipRef, isTriggeredBy, showTooltip, hideTooltip, getLatest]);\n\n  // Handle closing tooltip if trigger hidden\n  const isReferenceHidden =\n    popperProps?.state?.modifiersData?.hide?.isReferenceHidden;\n  React.useEffect(() => {\n    if (finalConfig.closeOnTriggerHidden && isReferenceHidden) hideTooltip();\n  }, [finalConfig.closeOnTriggerHidden, hideTooltip, isReferenceHidden]);\n\n  // Handle follow cursor\n  React.useEffect(() => {\n    if (!finalConfig.followCursor || triggerRef == null) return;\n\n    function setMousePosition({\n      clientX,\n      clientY,\n    }: {\n      clientX: number;\n      clientY: number;\n    }) {\n      virtualElement.getBoundingClientRect = generateBoundingClientRect(\n        clientX,\n        clientY\n      );\n      update?.();\n    }\n\n    triggerRef.addEventListener('mousemove', setMousePosition);\n    return () => triggerRef.removeEventListener('mousemove', setMousePosition);\n  }, [finalConfig.followCursor, triggerRef, update]);\n\n  // Handle tooltip DOM mutation changes (aka mutation observer)\n  React.useEffect(() => {\n    if (\n      tooltipRef == null ||\n      update == null ||\n      finalConfig.mutationObserverOptions == null\n    )\n      return;\n\n    const observer = new MutationObserver(update);\n    observer.observe(tooltipRef, finalConfig.mutationObserverOptions);\n    return () => observer.disconnect();\n  }, [finalConfig.mutationObserverOptions, tooltipRef, update]);\n\n  // Tooltip props getter\n  const getTooltipProps = (args: PropsGetterArgs = {}) => {\n    return {\n      ...args,\n      style: {\n        ...args.style,\n        ...styles.popper,\n      } as React.CSSProperties,\n      ...attributes.popper,\n      'data-popper-interactive': finalConfig.interactive,\n    };\n  };\n\n  // Arrow props getter\n  const getArrowProps = (args: PropsGetterArgs = {}) => {\n    return {\n      ...args,\n      ...attributes.arrow,\n      style: {\n        ...args.style,\n        ...styles.arrow,\n      } as React.CSSProperties,\n      'data-popper-arrow': true,\n    };\n  };\n\n  return {\n    getArrowProps,\n    getTooltipProps,\n    setTooltipRef,\n    setTriggerRef,\n    tooltipRef,\n    triggerRef,\n    visible,\n    ...popperProps,\n  };\n}\n"],"names":["useGetLatest","val","ref","React","useRef","current","useCallback","noop","useControlledState","initial","value","onChange","undefined","TypeError","useState","state","setState","getLatest","set","updater","updatedState","persist","isControlled","generateBoundingClientRect","x","y","width","height","top","right","bottom","left","toJSON","virtualElement","getBoundingClientRect","defaultConfig","closeOnOutsideClick","closeOnTriggerHidden","defaultVisible","delayHide","delayShow","followCursor","interactive","mutationObserverOptions","attributes","childList","subtree","offset","trigger","usePopperTooltip","config","popperOptions","finalConfig","Object","keys","reduce","key","defaultModifiers","useMemo","name","options","Array","isArray","finalPopperOptions","placement","modifiers","triggerRef","setTriggerRef","tooltipRef","setTooltipRef","visible","onVisibleChange","setVisible","timer","useEffect","clearTimeout","usePopper","styles","popperProps","update","isTriggeredBy","includes","hideTooltip","window","setTimeout","showTooltip","toggleTooltip","handleClickOutside","event","target","composedPath","Node","contains","document","addEventListener","removeEventListener","preventDefaultAndToggle","preventDefault","isReferenceHidden","modifiersData","hide","setMousePosition","clientX","clientY","observer","MutationObserver","observe","disconnect","getTooltipProps","args","style","popper","getArrowProps","arrow"],"mappings":"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"}